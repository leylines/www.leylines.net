{function debounce(t,e,i){var s;return function(){var n=this,a=arguments,r=function(){s=null,i||t.apply(n,a)},o=i&&!s;clearTimeout(s),s=setTimeout(r,e),o&&t.apply(n,a)}}let t={width:window.innerWidth,height:window.innerHeight},e=0;const i={image:{duration:900,delay:0,easing:[.8,0,.2,1]},more:{duration:900,delay:0,easing:[.8,0,.2,1]},facts:{duration:300,delay:0,easing:[.8,0,.2,1]},title:{duration:700,delay:200,easing:[.8,0,.2,1]},description:{duration:900,delay:400,easing:"easeOutExpo"},pagination:{duration:300,delay:400,easing:"easeInOutQuad"},menuCtrl:{duration:300,easing:[.2,1,.3,1]},menuItems:{duration:300,easing:[.2,1,.3,1]},factsCtrl:{duration:300,easing:"linear"},gallery:{duration:800,easing:[.2,1,.3,1]},navigationCtrls:{duration:800,easing:[.8,0,.2,1]},previewCloseCtrl:{duration:300,easing:"easeOutExpo"},factsItems:{duration:800,easing:[.8,0,.2,1]},expander:{duration:800,easing:[.8,0,.2,1]}};class s{constructor(t){this.DOM={el:t},this.init()}init(){this.DOM.title=this.DOM.el.querySelector(".section__content > .section__title"),charming(this.DOM.title),this.DOM.titleLetters=this.DOM.title.querySelectorAll("span"),this.DOM.description=this.DOM.el.querySelector(".section__content > .section__description"),this.DOM.image=this.DOM.el.querySelector(".section__img > .section__img-inner"),this.DOM.more=this.DOM.el.querySelector(".section__more > .section__more-inner"),this.DOM.expander=this.DOM.el.querySelector(".section__expander"),this.DOM.facts={wrapper:this.DOM.el.querySelector(".section__facts"),items:Array.from(this.DOM.el.querySelectorAll(".section__facts > .section__facts-item"))}}show(t){return this.isHidden=!1,this.toggle(t)}hide(t){return this.isHidden=!0,this.toggle(t)}toggle(t){return this.direction=t,Promise.all([this.toggleTitle(!this.isHidden),this.toggleDescription(!this.isHidden),this.toggleImage(!this.isHidden),this.toggleMore(!this.isHidden),this.toggleFacts(!this.isHidden)])}toggleTitle(){return anime.remove(this.DOM.titleLetters),anime({targets:this.DOM.titleLetters,duration:i.title.duration,delay:(t,e)=>30*e+i.title.delay,easing:i.title.easing,translateY:this.isHidden?[0,"next"===this.direction?"-100%":"100%"]:["next"===this.direction?"100%":"-100%",0],opacity:{value:this.isHidden?0:1,duration:1,delay:(t,e)=>this.isHidden?i.title.duration+i.title.delay:i.title.delay}}).finished}toggleDescription(){return anime.remove(this.DOM.description),anime({targets:this.DOM.description,duration:i.description.duration,delay:this.isHidden?i.description.delay:.5*i.description.duration+i.description.delay,easing:i.description.easing,translateY:this.isHidden?[0,"next"===this.direction?"-10%":"10%"]:["next"===this.direction?"20%":"-20%",0],opacity:this.isHidden?0:1}).finished}toggleImage(){return this.DOM.image.style.transformOrigin=this.isHidden?"50% 50%":`50% ${"next"===this.direction?0:100}%`,anime.remove(this.DOM.image),anime({targets:this.DOM.image,duration:i.image.duration,delay:i.image.delay,easing:i.image.easing,translateY:this.isHidden?["0%","next"===this.direction?"-100%":"100%"]:["next"===this.direction?"100%":"-100%","0%"],scale:this.isHidden?1:[1.8,1],opacity:{value:this.isHidden?0:1,duration:1,delay:this.isHidden?i.image.duration+i.image.delay:i.image.delay}}).finished}toggleMore(){return anime.remove(this.DOM.more),anime({targets:[this.DOM.more,this.DOM.more.children],duration:i.more.duration,delay:i.more.delay,easing:i.more.easing,translateY:this.isHidden?["0%","next"===this.direction?"-100%":"100%"]:["next"===this.direction?"100%":"-100%","0%"],opacity:{value:this.isHidden?0:1,duration:(t,e)=>e?i.more.duration/3:1,delay:(t,e)=>e?this.isHidden?100:.5*i.more.duration+i.more.delay:this.isHidden?i.more.duration+i.more.delay:i.more.delay}}).finished}toggleFacts(){return anime.remove(this.DOM.facts.items),anime({targets:this.DOM.facts.items.slice(0,2),duration:i.facts.duration,delay:(t,e)=>this.isHidden?40*e+i.facts.delay:40*e+.5*i.facts.duration+i.facts.delay,easing:i.facts.easing,translateY:this.isHidden?[this.DOM.facts.ty,"next"===this.direction?this.DOM.facts.ty-20:this.DOM.facts.ty+20]:["next"===this.direction?this.DOM.facts.ty+20:this.DOM.facts.ty-20,this.DOM.facts.ty],opacity:this.isHidden?0:1}).finished}}class n{constructor(t){this.DOM={},this.DOM.el=t,this.init()}init(){this.DOM.menuCtrl=this.DOM.el.querySelector(".sections__header > button.button-menu"),this.DOM.menu={wrapper:this.DOM.el.querySelector(".menu"),items:Array.from(this.DOM.el.querySelectorAll(".menu > .menu__inner > .menu__item")),menuCtrls:{toggle:this.DOM.el.querySelector(".menu > .menu__toggle"),open:this.DOM.el.querySelector(".menu > .menu__toggle > .menu__toggle-inner--open"),close:this.DOM.el.querySelector(".menu > .menu__toggle > .menu__toggle-inner--close")}},this.DOM.factsContainer=this.DOM.el.querySelector(".facts"),this.DOM.factsCtrls={toggle:this.DOM.factsContainer.querySelector(".facts__toggle"),more:this.DOM.factsContainer.querySelector(".facts__toggle > .facts__toggle-inner--more"),less:this.DOM.factsContainer.querySelector(".facts__toggle > .facts__toggle-inner--less")},this.DOM.previewCloseCtrl=this.DOM.factsContainer.querySelector(".button-contentclose"),this.DOM.pagination=this.DOM.el.querySelector(".sections__index .sections__index-inner"),this.DOM.navigation=this.DOM.el.querySelector(".sections__nav"),this.DOM.navigation.prevCtrl=this.DOM.navigation.querySelector("button.sections__nav-item--prev"),this.DOM.navigation.nextCtrl=this.DOM.navigation.querySelector("button.sections__nav-item--next"),this.DOM.entries=Array.from(this.DOM.el.querySelectorAll(".section"),t=>new s(t)),this.entriesTotal=this.DOM.entries.length,this.currentPos=0,this.layout(),this.initEvents()}layout(){this.currentEntry=this.DOM.entries[this.currentPos];const e=this.currentEntry.DOM.facts.items[0],i=e.getBoundingClientRect().height+parseFloat(window.getComputedStyle(e).marginBottom),s=window.getComputedStyle(this.currentEntry.DOM.facts.wrapper),n=parseFloat(s.paddingTop)+parseFloat(s.paddingBottom);this.factsTranslation=t.height-2*i-n;for(let t=0;t<=this.entriesTotal-1;++t){const e=this.DOM.entries[t];e.DOM.expander.style.transform=`scale3d(0.54,1,1) translate3d(0px,${this.factsTranslation}px,0px)`;for(let i=0,s=e.DOM.facts.items.length;i<=s-1;++i){e.DOM.facts.ty=this.factsTranslation;const s=e.DOM.facts.items[i];s.style.transform=`translate3d(0px,${this.factsTranslation}px,0px)`,i>1?s.style.opacity=0:t===this.currentPos&&(s.style.opacity=1)}}}initEvents(){this.onPrevClick=()=>this.navigate("prev"),this.onNextClick=()=>this.navigate("next"),this.DOM.navigation.prevCtrl.addEventListener("click",this.onPrevClick),this.DOM.navigation.nextCtrl.addEventListener("click",this.onNextClick),this.DOM.menu.menuCtrls.toggle.addEventListener("click",()=>this.toggleMenu()),this.DOM.factsCtrls.toggle.addEventListener("click",()=>this.toggleFactsContainer());for(let t=0;t<=this.entriesTotal-1;++t){this.DOM.entries[t].DOM.facts.items.filter(t=>t.classList.contains("section__facts-item--clickable")).forEach(t=>t.addEventListener("click",()=>this.preview(t.dataset.gallery)))}this.DOM.previewCloseCtrl.addEventListener("click",()=>this.closePreview()),this.onResize=()=>{t={width:window.innerWidth,height:window.innerHeight},this.layout(),this.isFactsOpen&&(this.DOM.factsCtrls.more.style.opacity=1,this.DOM.factsCtrls.less.style.opacity=0,this.isFactsOpen=!this.isFactsOpen,this.toggleNavigationCtrls({opacity:1,duration:1}),this.isFactsAnimating=!1),this.gallery&&(this.DOM.previewCloseCtrl.style.opacity=0,this.toggleGallery(this.gallery,{duration:1,opacity:0}).then(()=>this.gallery=null)),this.DOM.el.classList.remove("sections--factsopen")},window.addEventListener("resize",debounce(()=>this.onResize(),20)),this.onScroll=()=>{newValue=window.pageYOffset,e-newValue<0?this.onPrevClick:e-newValue>0&&(this.onNextClick,console.log("down")),e=newValue},window.addEventListener("scroll",debounce(()=>this.onScroll(),20))}navigate(t){if(this.isEntriesAnimating||this.isFactsAnimating)return;this.isEntriesAnimating=!0,this.direction=t;const e=this.currentPos="next"===this.direction?this.currentPos<this.entriesTotal-1?this.currentPos+1:0:this.currentPos=this.currentPos>0?this.currentPos-1:this.entriesTotal-1,i=this.DOM.entries[e];this.update(i)}update(t){const e=()=>{Promise.all([this.currentEntry.hide(this.direction),t.show(this.direction),this.updatePageNumber()]).then(()=>{this.isEntriesAnimating=!1,this.currentEntry.DOM.el.classList.remove("section--current"),t.DOM.el.classList.add("section--current"),this.currentEntry=t})};this.isFactsOpen?this.toggleFactsContainer().then(e):e()}updatePageNumber(){anime.remove(this.DOM.pagination);let t=!1;return anime({targets:this.DOM.pagination,duration:i.pagination.duration,easing:"easeInOutQuad",translateY:[{value:"next"===this.direction?"-100%":"100%",delay:i.pagination.delay},{value:["next"===this.direction?"100%":"-100%","0%"],delay:i.pagination.duration}],opacity:[{value:0,delay:i.pagination.delay},{value:[0,1],delay:i.pagination.duration}],update:e=>{e.progress>=50&&!t&&(t=!0,this.DOM.pagination.innerHTML=`0${this.currentPos+1}`)}}).finished}toggleMenu(){if(this.isMenuAnimating)return;this.isMenuAnimating=!0;this.DOM.menu.wrapper.classList.toggle("menu--open"),Promise.all([(()=>(anime.remove([this.DOM.menu.menuCtrls.open,this.DOM.menu.menuCtrls.close]),anime({targets:[this.DOM.menu.menuCtrls.open,this.DOM.menu.menuCtrls.close],duration:i.menuCtrl.duration,easing:i.menuCtrl.easing,opacity:(t,e)=>e?this.isMenuOpen?0:1:this.isMenuOpen?1:0,translateX:(t,e)=>e?this.isMenuOpen?"50%":["50%","0%"]:this.isMenuOpen?"0%":["0%","-50%"]}).finished))(),(()=>(anime.remove(this.DOM.menu.items),anime({targets:this.DOM.menu.items,duration:i.menuItems.duration,easing:i.menuItems.easing,delay:(t,e)=>this.isMenuOpen?0:80*e,translateX:this.isMenuOpen?"0%":["5%","0%"],opacity:{value:this.isMenuOpen?0:[0,1],easing:"linear",delay:(t,e,i)=>this.isMenuOpen?0:80*e}}).finished))()]).then(()=>{this.isMenuOpen=!this.isMenuOpen,this.isMenuAnimating=!1})}toggleFactsContainer(){if(!(this.isFactsAnimating||this.isEntriesAnimating&&!this.isFactsOpen))return this.isFactsAnimating=!0,Promise.all([this.toggleFactsCtrl(),this.animateExpander(),this.animateFactsItems()]).then(()=>{this.isFactsOpen=!this.isFactsOpen,this.isFactsAnimating=!1})}preview(t){!this.isFactsAnimating&&t&&(this.isFactsAnimating=!0,this.gallery=t,this.DOM.el.classList.add("sections--factsopen"),Promise.all([this.toggleNavigationCtrls({opacity:0}),this.toggleFactsCtrl({delay:0,opacity:0}),this.animateExpander({translateY:0,scaleX:1.05}),this.animateFactsItems({translateY:0,opacity:0,delay:0}),this.togglePreviewCloseCtrl({opacity:1,delay:800}),this.toggleGallery(t,{opacity:1,scale:(t,e)=>e?[.7,1]:[1,1],delay:(t,e)=>e?100*e+700:700})]).then(()=>this.isFactsAnimating=!1))}closePreview(){this.isFactsAnimating||(this.isFactsAnimating=!0,Promise.all([this.toggleNavigationCtrls({opacity:1}),this.toggleFactsCtrl({delay:600,opacity:(t,e)=>e}),this.animateExpander({translateY:0,scaleX:.54}),this.animateFactsItems({translateY:0,opacity:1,delay:200}),this.togglePreviewCloseCtrl({opacity:0}),this.toggleGallery(this.gallery,{opacity:0})]).then(()=>{this.isFactsAnimating=!1,this.gallery=null,this.DOM.el.classList.remove("sections--factsopen")}))}animateExpander(t){return this.animate(Object.assign({targets:this.currentEntry.DOM.expander,duration:i.expander.duration,easing:i.expander.easing,delay:this.isFactsOpen?300:0,translateY:this.isFactsOpen?this.factsTranslation:[this.factsTranslation,0],scaleX:[.54,.54]},t))}animateFactsItems(t){return this.animate(Object.assign({targets:this.currentEntry.DOM.facts.items,duration:i.factsItems.duration,easing:i.factsItems.easing,delay:(t,e,i)=>this.isFactsOpen?30*(i-e-1):30*(e+1)+150,translateY:this.isFactsOpen?this.factsTranslation:[this.factsTranslation,0],opacity:(t,e)=>this.isFactsOpen&&e>1?0:1},t))}toggleFactsCtrl(t){return this.animate(Object.assign({targets:[this.DOM.factsCtrls.more,this.DOM.factsCtrls.less],duration:i.factsCtrl.duration,easing:i.factsCtrl.easing,opacity:(t,e)=>e?this.isFactsOpen?0:1:this.isFactsOpen?1:0},t))}togglePreviewCloseCtrl(t){return this.animate(Object.assign({targets:this.DOM.previewCloseCtrl,duration:i.previewCloseCtrl.duration,easing:i.previewCloseCtrl.easing},t))}toggleNavigationCtrls(t){return this.animate(Object.assign({targets:[this.DOM.navigation.prevCtrl,this.DOM.navigation.nextCtrl],duration:i.navigationCtrls.duration,easing:i.navigationCtrls.easing},t))}toggleGallery(t,e){return this.animate(Object.assign({targets:this.DOM.el.querySelectorAll(`#${t} > .section__gallery-item`),duration:i.gallery.duration,easing:i.gallery.easing},e))}animate(t){return anime.remove(t.targets),anime(t).finished}}imagesLoaded(document.querySelectorAll("img"),()=>{document.body.classList.remove("loading"),new n(document.querySelector(".sections"))})}
//# sourceMappingURL=main.min.js.map